# Microsoft Employees
#region URI
$uri = 'https://query.wikidata.org/sparql?query=SELECT%20%0A%20%20%20%20%3Fitem%20%0A%20%20%20%20%3FitemLabel%20%0A%20%20%20%20%3FGitHub_username%20%0A%20%20%20%20%3FTwitter_username%20%0A%20%20%20%20%0A%20%20%20%20%3Fdate_of_birthLabel%20%0A%20%20%20%20%3Fplace_of_birthLabel%20%0A%20%20%20%20(group_concat(distinct%20%3Fcountry_of_citizenshipLabel%3Bseparator%3D%22%2C%22)%20as%20%3FarrCitizenship)%20%0A%20%20%20%20%0A%20%20%20%20(group_concat(distinct%20%3Fnotable_workLabel%3Bseparator%3D%22%2C%22)%20as%20%3FarrNotableWork)%20%0A%20%20%20%20(group_concat(distinct%20%3Faward_receivedLabel%3Bseparator%3D%22%2C%22)%20as%20%3FarrAwardReceived)%20%0A%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%3Fofficial_website%20%0A%20%20%20%20%3Fofficial_blog%0A%20%20%20%20%0A%20%20%20%20(group_concat(distinct%20%3Fgiven_nameLabel%3Bseparator%3D%22%20%22)%20as%20%3FarrGivenName)%20%23%20givenNames%20are%20separate%20values%20in%20the%20DB%0A%20%20%20%20%3Ffamily_nameLabel%20%20%20%20%20%0A%0AWHERE%20%7B%0A%20%20%20%20SERVICE%20wikibase%3Alabel%20%7B%20%0A%20%20%20%20%20%20%20%20bd%3AserviceParam%20wikibase%3Alanguage%20%22%5BAUTO_LANGUAGE%5D%2Cen%22.%20%0A%20%20%20%20%20%20%20%20%3Fitem%20rdfs%3Alabel%20%3FitemLabel.%20%20%20%20%0A%20%20%20%20%20%20%20%20%3Fnotable_work%20rdfs%3Alabel%20%3Fnotable_workLabel.%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%3Fgiven_name%20rdfs%3Alabel%20%3Fgiven_nameLabel.%0A%20%20%20%20%20%20%20%20%3Ffamily_name%20rdfs%3Alabel%20%3Ffamily_nameLabel.%0A%20%20%20%20%20%20%20%20%3Fdate_of_birth%20rdfs%3Alabel%20%3Fdate_of_birthLabel.%20%0A%20%20%20%20%20%20%20%20%3Fplace_of_birth%20rdfs%3Alabel%20%3Fplace_of_birthLabel%20.%0A%20%20%20%20%20%20%20%20%3Fcountry_of_citizenship%20rdfs%3Alabel%20%3Fcountry_of_citizenshipLabel.%0A%20%20%20%20%20%20%20%20%3Faward_received%20rdfs%3Alabel%20%3Faward_receivedLabel.%20%20%20%0A%20%20%20%20%7D%0A%20%20%0A%20%20%20%20%3Fitem%20wdt%3AP108%20wd%3AQ2283.%20%20%20%20%20%20%20%20%20%20%20%20%23%20%3F%20has%20employer%20MSFT%20%20%20%20%20%20%20%20%0A%20%20%20%20%23%20%3Fitem%20wdt%3AP800%20%3Fnotable_work.%20%20%20%20%20%23%20%3F%20has%20a%20notable%20work%0A%20%20%0A%20%20%20%20%23FILTER(BOUND(%3Fnotable_work))%20%20%20%20%0A%20%20%20%20%23FILTER(%221969-01-01%22%5E%5Exsd%3AdateTime%20%3C%3D%20%3Fdate_of_birth%20%20%26%26%20%3Fdate_of_birth%20%20%3C%20%221969-12-31%22%5E%5Exsd%3AdateTime).%0A%20%20%0A%20%20%20%20OPTIONAL%20%7B%20%3Fitem%20wdt%3AP2002%20%3FTwitter_username.%20%7D%0A%20%20%20%20OPTIONAL%20%7B%20%3Fitem%20wdt%3AP2037%20%3FGitHub_username.%20%7D%0A%20%20%20%20OPTIONAL%20%7B%20%3Fitem%20wdt%3AP735%20%3Fgiven_name.%20%7D%0A%20%20%20%20OPTIONAL%20%7B%20%3Fitem%20wdt%3AP734%20%3Ffamily_name.%20%7D%0A%20%20%20%20OPTIONAL%20%7B%20%3Fitem%20wdt%3AP569%20%3Fdate_of_birth.%20%7D%0A%20%20%20%20OPTIONAL%20%7B%20%3Fitem%20wdt%3AP19%20%3Fplace_of_birth.%20%7D%0A%20%20%20%20OPTIONAL%20%7B%20%3Fitem%20wdt%3AP27%20%3Fcountry_of_citizenship.%20%7D%0A%20%20%20%20OPTIONAL%20%7B%20%3Fitem%20wdt%3AP800%20%3Fnotable_work.%20%7D%20%20%0A%20%20%20%20OPTIONAL%20%7B%20%3Fitem%20wdt%3AP166%20%3Faward_received.%20%7D%0A%20%20%20%20OPTIONAL%20%7B%20%3Fitem%20wdt%3AP856%20%3Fofficial_website.%20%7D%0A%20%20%20%20OPTIONAL%20%7B%20%3Fitem%20wdt%3AP1581%20%3Fofficial_blog.%20%7D%20%20%0A%7D%0AGROUP%20BY%20%0A%20%20%20%20%3Fitem%20%0A%20%20%20%20%3FitemLabel%20%0A%20%20%20%20%3FGitHub_username%20%0A%20%20%20%20%3FTwitter_username%20%0A%20%20%20%20%3FarrGivenname%20%0A%20%20%20%20%3Ffamily_nameLabel%20%0A%20%20%20%20%3Fdate_of_birthLabel%20%0A%20%20%20%20%3Fplace_of_birthLabel%20%0A%20%20%20%20%3FarrAwardReceived%20%0A%20%20%20%20%3FarrNotableWork%20%23%20OR%3A%20having(count(%3Fnotable_workLabel)%20%3E%3D%201)%0A%20%20%20%20%3FarrCitizenship%20%0A%20%20%20%20%3Fofficial_website%20%0A%20%20%20%20%3Fofficial_blog%20%20%20%20%20%20%20%20%20%20%20%0A%0A%23%20HAVING(COUNT(%3Faward_received)%20%3E%3D%201%20%26%26%20COUNT(%3Fnotable_work)%20%3E%3D%201)%0A%0ALIMIT%201000%0A'
#endregion

$result = Invoke-RestMethod -Uri $uri -Headers @{'Accept'='text/csv' } | ConvertFrom-Csv
$result.count
$result | Out-GridView
$result | Group-Object -Property arrCitizenship | Where-Object -FilterScript { $_.Count -gt 1} | Sort-Object -Property Count -Descending | Format-Table -AutoSize -Property Count, Name
$result | Where-Object -FilterScript { $_.arrCitizenship -like '*,*'}  | Group-Object -Property arrCitizenship | Format-Table -AutoSize -Property Count, Name
| Sort-Object -Property Count -Descending

$result | Export-Excel -Path 'MSFT_Employees_FromWikidata.xlsx' -WorksheetName 'Employees' -FreezeTopRow -Show -AutoSize 
 